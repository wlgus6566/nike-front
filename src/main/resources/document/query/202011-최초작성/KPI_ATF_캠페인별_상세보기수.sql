-- 캠페인별 상세보기 수
SELECT TC.TOP_MENU_CODE, TC.MENU_CODE, SUM(TC.READ_COUNT) AS SUM
FROM TB_CONTENTS TC
GROUP BY TC.TOP_MENU_CODE, TC.MENU_CODE
;

SELECT *
FROM TB_USER_ACTION_LOG TUAL
WHERE TUAL.METHOD_SIGNATURE = 'findContents'
AND TUAL.METHOD_TYPE_NAME = 'GET'
AND TUAL.URL LIKE '%ASSET%'













SELECT tc.CONTENTS_SEQ, tc.FOLDER_NAME
     , SUM(CASE
               WHEN T.REGISTRATION_DT BETWEEN '2020-11-13 11:35:00' AND '2020-11-30 23:59:59' THEN 1
               WHEN T.REGISTRATION_DT BETWEEN '2020-12-01 00:00:00' AND '2020-12-05 23:59:59' THEN 0
               ELSE 0
    END) 'ELE'
#       , SUM(CASE
#                 WHEN T.REGISTRATION_DT BETWEEN '2020-11-13 11:35:00' AND '2020-11-30 23:59:59' THEN 0
#                 WHEN T.REGISTRATION_DT BETWEEN '2020-12-01 00:00:00' AND '2020-12-05 23:59:59' THEN 1
#                 ELSE 0
#         END) 'ELE'
FROM TB_CONTENTS tc
LEFT JOIN (
    SELECT SUBSTRING_INDEX(TUAL.URL, '/', -1) AS CONTENTS_SEQ, TUAL.REGISTRATION_DT
    FROM TB_USER_ACTION_LOG TUAL
    WHERE TUAL.METHOD_SIGNATURE = 'findContents'
    AND REGISTRATION_DT BETWEEN '2020-11-01 11:35:00' AND '2020-11-30 23:59:59'
) T
ON T.CONTENTS_SEQ = tc.CONTENTS_SEQ
WHERE tc.TOP_MENU_CODE = 'ASSET'
GROUP BY tc.CONTENTS_SEQ